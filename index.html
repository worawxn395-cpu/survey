<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg,#e0f2fe,#f0f9ff);
      padding: 20px;
    }

    .card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      animation: fadeIn 0.4s ease;
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
    }

    .question-title {
      font-size: 18px;
      margin-bottom: 12px;
      font-weight: 600;
    }

    .emoji-group {
      display: flex;
      justify-content: space-between;
      max-width: 300px;
      margin: auto;
    }

    .emoji {
      font-size: 28px;
      cursor: pointer;
      padding: 10px;
      border-radius: 50%;
      transition: all 0.25s ease;
    }

    .emoji:hover {
      transform: scale(1.2);
    }

    .selected {
      background: linear-gradient(135deg,#3b82f6,#2563eb);
      color: white;
      transform: scale(1.4);
      box-shadow: 0 6px 15px rgba(37,99,235,0.4);
    }

    .faded {
      opacity: 0.4;
    }

    button {
      display: block;
      margin: 30px auto;
      padding: 12px 30px;
      border: none;
      border-radius: 30px;
      font-size: 16px;
      background: linear-gradient(135deg,#10b981,#059669);
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 15px rgba(5,150,105,0.4);
    }

    @keyframes fadeIn {
      from {opacity:0; transform: translateY(10px);}
      to {opacity:1; transform: translateY(0);}
    }

    .success {
      text-align:center;
      font-size:18px;
      color:#059669;
      display:none;
    }
  </style>
</head>

<body>

  <h2>‚ú® ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à ‚ú®</h2>

  <div id="form"></div>

  <button onclick="submitForm()">‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>

  <div class="success" id="successMsg">
    ‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞
  </div>

<script>
let questions = [
  "‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°",
  "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß",
  "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô",
  "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏†‡∏≤‡∏û"
];

let emojis = ["üò°","üòï","üòê","üòä","üòç"];
let answers = {};

function loadForm(){
  const form = document.getElementById("form");

  questions.forEach((q,index)=>{
    let card = document.createElement("div");
    card.className = "card";

    let title = document.createElement("div");
    title.className = "question-title";
    title.innerText = q;

    let group = document.createElement("div");
    group.className = "emoji-group";

    emojis.forEach(e=>{
      let span = document.createElement("span");
      span.className = "emoji";
      span.innerText = e;

      span.onclick = function(){
        selectEmoji(this,index);
      }

      group.appendChild(span);
    });

    card.appendChild(title);
    card.appendChild(group);
    form.appendChild(card);
  });
}

function selectEmoji(element,questionIndex){
  const parent = element.parentElement;
  const all = parent.querySelectorAll(".emoji");

  all.forEach(e=>{
    e.classList.remove("selected");
    e.classList.add("faded");
  });

  element.classList.remove("faded");
  element.classList.add("selected");

  answers[questionIndex] = element.innerText;
}

function submitForm(){
  if(Object.keys(answers).length < questions.length){
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠");
    return;
  }

  google.script.run.saveData(answers);

  document.getElementById("successMsg").style.display="block";
}

loadForm();
</script>

</body>
</html>
